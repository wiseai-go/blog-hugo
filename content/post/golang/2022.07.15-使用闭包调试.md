---
author: "wiseai"
title: "Go程序使用闭包调试"
date: 2022-07-15T22:25:10+08:00
description: ""
tags:
- 编程
categories:
- golang学习
draft: false
---
# 6.10 使用闭包调试

当您在分析和调试复杂的程序时，无数个函数在不同的代码文件中相互调用，如果这时候能够准确地知道哪个文件中的具体哪个函数正在执行，对于调试是十分有帮助的。您可以使用 `runtime` 或 `log` 包中的特殊函数来实现这样的功能。包 `runtime` 中的函数 `Caller()` 提供了相应的信息，因此可以在需要的时候实现一个 `where()` 闭包函数来打印函数执行的位置：

```
where := func() {
	_, file, line, _ := runtime.Caller(1)
	log.Printf("%s:%d", file, line)
}
where()
// some code
where()
// some more code
where()
```

您也可以设置 `log` 包中的 `flag` 参数来实现：

```
log.SetFlags(log.Llongfile)
log.Print("")
```

或使用一个更加简短版本的 `where()` 函数：

```
var where = log.Print
func func1() {
where()
... some code
where()
... some code
where()
}
```